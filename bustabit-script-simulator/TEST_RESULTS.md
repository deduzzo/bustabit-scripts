# Test Results - New Provably Fair Algorithm

## Test Case: Game #12424169

**Test Hash:** `4488d92d89d0ed7fbb2ea23b219d569f63207e32fc44b957858838835c1719f1`
**Expected Bust:** 1.46x
**Calculated Bust:** 1.46x
**Status:** ✅ **PASS**

### Calculation Details

```
GAME_SALT: 00000000000000000001e08b7fd44f95e3e950ac65650a8031a6d5e1750e34be
Game Hash: 4488d92d89d0ed7fbb2ea23b219d569f63207e32fc44b957858838835c1719f1

Step 1: HMAC_SHA256(key=GAME_SALT, message=gameHash)
Result: 53574071c0ebced216d79e65949604ad0cbff98443578ab04786ecfa1d0730b8

Step 2: Extract first 52 bits (13 hex chars)
Hex: 53574071c0ebc
Decimal (r): 1466147335311036

Step 3: Normalize X = r / 2^52
X: 0.3255501058310264

Step 4: Transform X = 99 / (1 - X)
X: 146.78629332722082

Step 5: floor(X) / 100
floor(X): 146
Result: 1.46x ✓
```

## Verification Against Bustabit Official Verifier

The test hash was verified against the official bustabit verifier at:
https://bustabit.github.io/verifier

**Result:** Matches perfectly with 1.46x

## Algorithm Implementation

The simulator now correctly implements the bustabit provably fair algorithm:

### Current Seeding Event (Games > 12,279,450)
- Uses `GAME_SALT`: Bitcoin block #831500 hash
- Algorithm: `HMAC_SHA256(GAME_SALT, gameHash)` → bust calculation
- No BLS signatures needed (classic scheme)

### VX Seeding Event (Games 10,000,001 - 12,279,450)
- Uses BLS signatures with VX public key
- Algorithm: `HMAC_SHA256(vxSignature, gameHash)` → bust calculation
- VX_GAME_SALT: Bitcoin block used for VX event

### Previous Seeding Event (Games 1 - 10,000,000)
- Uses `PREV_GAME_SALT`: Original game salt
- Same HMAC algorithm as current
- Hash chain generated by SHA256(hex(previous_hash))

## Files Modified

1. **src/data/newProvablyFair.js**
   - Added all three seeding event constants
   - Implemented correct `gameResult()` function
   - Uses proper GAME_SALT by default

2. **src/data/simulate.js**
   - Updated to use new algorithm when `USE_NEW_ALGORITHM = true`
   - Passes correct salt to game generation

3. **NEW_SEEDING_ALGORITHM.md**
   - Complete documentation of the algorithm
   - Examples and usage instructions

## Test Status

✅ Hash calculation verified
✅ Algorithm matches official bustabit verifier
✅ Code compiles successfully
✅ All constants from official seeding events included

## Next Steps

The simulator is now ready to use with the correct provably fair algorithm. You can:

1. Run simulations with realistic game results
2. Verify any bustabit game hash
3. Test scripts with actual game data
4. Toggle between old and new algorithms for comparison

## References

- Official Bustabit Verifier: https://github.com/bustabit/verifier
- Current Seeding Event: Bitcoin block #831500
- VX Public Key: `b40c94495f6e6e73619aeb54ec2fc84c5333f7a88ace82923946fc5b6c8635b08f9130888dd96e1749a1d5aab00020e4`
- Terminating Hash: `567a98370fb7545137ddb53687723cf0b8a1f5e93b1f76f4a1da29416930fa59`
